!function () { function t(t) { return d.call(t) } function e(t, e, n) { try { l.call(t, e, n) } catch (o) { } } function n(t, e) { s.call(t, e) } function o(t) { return y.call(t) } function r(t) { for (; t.childNodes.length;) t.removeChild(t.lastChild) } function c(t, e, n) { u.value.call(t, e, n) } function a() { var t = !0; try { f.innerHTML = "<test/>" } catch (e) { t = !1 } return t } function i(a, i) { function p(r) { var c = t(r); if (c && c.length) { for (var a, i = 0, l = c.length; l > i; i++) { var s = c[i], u = s.name; "o" !== u[0] && "O" !== u[0] || "n" !== u[1] && "N" !== u[1] || (a = a || [], a.push({ name: s.name, value: s.value })) } if (a) for (var i = 0, l = a.length; l > i; i++) { var s = a[i]; n(r, s.name), e(r, "x-" + s.name, s.value) } } for (var d = o(r), i = 0, l = d.length; l > i; i++) p(d[i]) } var l = document.implementation.createHTMLDocument("cleaner"); r(l.documentElement), MSApp.execUnsafeLocalFunction(function () { c(l.documentElement, "afterbegin", a) }); var s = l.documentElement.querySelectorAll("script"); Array.prototype.forEach.call(s, function (t) { switch (t.type.toLowerCase()) { case "": t.type = "text/inert"; break; case "text/javascript": case "text/ecmascript": case "text/x-javascript": case "text/jscript": case "text/livescript": case "text/javascript1.1": case "text/javascript1.2": case "text/javascript1.3": t.type = "text/inert-" + t.type.slice(5); break; case "application/javascript": case "application/ecmascript": case "application/x-javascript": t.type = "application/inert-" + t.type.slice(12) } }), p(l.documentElement); var u = []; return "HTML" === i.tagName ? u = Array.prototype.slice.call(document.adoptNode(l.documentElement).childNodes) : (l.head && (u = u.concat(Array.prototype.slice.call(document.adoptNode(l.head).childNodes))), l.body && (u = u.concat(Array.prototype.slice.call(document.adoptNode(l.body).childNodes)))), u } function p(t, e) { var n = Object.getOwnPropertyDescriptor(HTMLElement.prototype, t), o = n.set; Object.defineProperty(HTMLElement.prototype, t, { get: n.get, set: function (t) { if (window.WinJS && window.WinJS._execUnsafe && a()) o.call(this, t); else { var r = this, c = i(t, r); MSApp.execUnsafeLocalFunction(function () { e(n, r, c) }) } }, enumerable: n.enumerable, configurable: n.configurable }) } if (window.MSApp && MSApp.execUnsafeLocalFunction) { var l = Object.getOwnPropertyDescriptor(Element.prototype, "setAttribute").value, s = Object.getOwnPropertyDescriptor(Element.prototype, "removeAttribute").value, u = Object.getOwnPropertyDescriptor(HTMLElement.prototype, "insertAdjacentHTML"), d = Object.getOwnPropertyDescriptor(Node.prototype, "attributes").get, y = Object.getOwnPropertyDescriptor(Node.prototype, "childNodes").get, f = document.createElement("div"); p("innerHTML", function (t, e, n) { r(e); for (var o = 0, c = n.length; c > o; o++) e.appendChild(n[o]) }), p("outerHTML", function (t, e, n) { for (var o = 0, r = n.length; r > o; o++) e.insertAdjacentElement("afterend", n[o]); e.parentNode.removeChild(e) }) } }();